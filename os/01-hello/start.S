#include "platform.h"

    # ？？？ .equ??????????????????????????????????????????????
    .equ    STACK_SIZE,1024     # 栈的大小设置1024

    .global _start  # ???

    .text   # ???

# 1. 判断当前hartid

_start:
    csrr    t0,mhartid
    mv  tp,t0
    bnez    t0,park
    # 2.hartid 不为0的hart跳走，为0的初始化栈指针

    slli    t0,t0,10                # 左移 10位
    la sp,stacks + STACK_SIZE       # 请问这是申请了 1024*8 +1024 栈的内存吗？？？？？？？？？？？？？？？？
    add sp,sp,t0                    # 1024*8 +1024 再加上0吗？？？？？？？？？？？？？？？？？？？？？？？？？？？？

    j   start_kernel

# 本系统暂时只运行在一个hart上，其他的hart 不断休眠
park:
    wfi
    j park

.align 16   # ???
# ?????????????????????????????????????????????
stacks:
    .skip   STACK_SIZE * MAXNUM_CPU

    .end